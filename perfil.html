<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Perfil</title>
  <link rel="stylesheet" type="text/css" href="css/styleperfil.css">
</head>
<body>
  <header class="cabecalho">
    <h3 class="cabecalho-titulo">Segue<br>O Festival!</h3>
    <img class="cabecalho-imagem" src="imagens/perfilsof.jpg" alt="Imagem do Perfil">
  </header>

  <main>
    <h1 class="conteudo-titulo">Perfil</h1>
    <div>
      <img class="conteudo-imagem" src="imagens/perfilsof.jpg" alt="Foto de Perfil">
    </div>

    <section class="conteudo-formulario">
      <div class="dados-pessoais-informacoes">
        <div class="dados-pessoais-nome">
          <p>Nome Completo</p>
          <input class="dados-pessoais-nome-formulario" type="text" id="txtNome" placeholder="Nome Completo"/>
        </div>

        <div class="dados-pessoais-baixo">
          <div class="dados-pessoais-telefone">
            <p>CPF</p>
            <input class="dados-pessoais-telefone-formulario" type="tel" id="telCPF" placeholder="Insira seu CPF">
          </div>

          <div class="dados-pessoais-datanascimento">
            <p>Data de Nascimento</p>
            <input class="dados-pessoais-datanascimento-formulario" type="date" id="dateNascimento">
          </div>

          <div class="dados-pessoais-sexo">
            <p>Sexo</p>
            <select class="dados-pessoais-sexo-formulario" id="sexo" name="sexo">
              <option value="feminino">Feminino</option>
              <option value="masculino">Masculino</option>
              <option value="nao_informar">Prefiro não informar</option>
            </select>
          </div>
        </div>
      </div>

      <div class="dados-pessoais-morada">
        <!-- Endereço omitido por não estar no banco ainda -->
      </div>

      <div class="dados-pessoais-usuario">
        <div class="dados-pessoais-email">
          <p>E-mail</p>
          <input class="dados-pessoais-email-formulario" type="email" id="emailEm" placeholder="E-mail"/>
        </div>

        <div class="dados-pessoais-senha">
          <p>Trocar de Senha</p>
          <input class="dados-pessoais-senha-formulario" type="password" id="passwordSen" placeholder="Trocar de Senha"/>
        </div>
      </div>
    </section>
  </main>

  <footer></footer>

  <script>
    async function carregarDadosUsuario() {
      const cpf = '12345678900'; // <-- Aqui você pode pegar de uma variável global, sessão ou localStorage

      try {
        const response = await fetch(`/api/dados_usuario.js?cpf=${cpf}`);
        if (!response.ok) {
          throw new Error('Erro ao buscar dados do usuário');
        }

        const dados = await response.json();

        document.getElementById('txtNome').value = dados.nome || '';
        document.getElementById('telCPF').value = dados.cpf || '';
        document.getElementById('dateNascimento').value = dados.data_nascimento || '';
        document.getElementById('emailEm').value = dados.email_usuario || '';
        document.getElementById('passwordSen').value = dados.senha_usuario || '';
        // Campos como sexo e endereço podem ser preenchidos futuramente
      } catch (error) {
        console.error('Erro ao carregar dados do usuário:', error);
      }
    }

    document.addEventListener('DOMContentLoaded', carregarDadosUsuario);
  </script>
</body>
</html>
